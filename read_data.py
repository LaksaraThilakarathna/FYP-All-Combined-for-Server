import os
import pickle
import math
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import joblib
from scipy import stats as st

from scipy.interpolate import UnivariateSpline
from noise_reduction import *
from feature_extraction import *
from peak_detection import *
from main import *

fs_dict_BVP = 60  # frequency
cycle = 15
file_path = "trained_binary_model/pt1.csv"
temp_ths = [1.0, 2.0, 1.8, 1.5]  # std_, kurt, skews

models = ['AB_model', 'DT_model', 'GB_model',
          'KN_model', 'LDA_model', 'RF_model', 'SVM_model']

feats = ['HR_mean', 'HR_std', 'meanNN', 'SDNN', 'medianNN', 'meanSD', 'SDSD', 'RMSSD', 'pNN20', 'pNN50', 'TINN', 'LF', 'HF', 'ULF', 'VLF', 'LFHF',
         'total_power', 'lfp', 'hfp', 'SD1', 'SD2', 'pA', 'pQ', 'ApEn', 'shanEn', 'D2']


def PPG_ML_output(dataframe, feats, models):
    results = []

    # mean_std = pd.read_csv(mean_std_path, index_col=0).values
    mean = [7.59829670e+01, 1.10479738e+01, 8.31784498e+02, 1.23090146e+02, 8.16199267e+02, 1.19642124e+02, 1.09777805e+02, 1.63360789e+02,
            9.61310363e-03, 6.86243424e-03, 5.43510428e+02, 1.57929844e+18, 7.41346968e+18, 0.00000000e+00, 3.57286785e+17, 5.03060620e-01,
            9.35005490e+18, 2.68481955e-01, 6.42010059e-01, 1.16222863e+02, 4.45791619e+04, 6.10478333e+06, 3.31720393e-03, 1.93333810e-01, 4.40096395e+00, 1.21661119e+00]

    std = [1.42100639e+01, 4.22814853e+00, 1.33128019e+02, 3.26321332e+01, 1.40609127e+02, 4.63001917e+01, 2.87340068e+01, 5.14587972e+01, 2.59335452e-03, 2.32686887e-03, 5.42938134e+01, 3.53368583e+19, 1.73862281e+20, 1, 7.87884550e+18, 4.66362630e-01,
           2.16846564e+20, 1.07021633e-01, 1.45102434e-01, 3.67691019e+01, 2.56393920e+04, 4.98834484e+06, 1.67620506e-03, 2.02594461e-01, 3.79818465e-01, 3.07081347e-01]

    data = dataframe[feats].values
    x = data[0]-mean
    # print(x)
    np.seterr(invalid='ignore')
    np.seterr(divide='ignore', invalid='ignore')
    x = np.divide(x, std)
    # print(x)
    where_are_NaNs = np.isnan(x)
    x[where_are_NaNs] = 0
    where_are_inf = np.isinf(x)
    x[where_are_inf] = 0
    # print("x: ", x)
    for model in models:
        saved_model = joblib.load(model + '.pkl')
        y_pred = saved_model.predict([x])[0]
        print(model, ': ', y_pred)
        results.append(y_pred)
        # result = st.mode(results).mode[0]
    return results


def EDA_ML_output(dataframe, feats, models):
    results = []

    # mean_std = pd.read_csv(mean_std_path, index_col=0).values
    mean = [9.722679, 0.130046, 0.27907]

    std = [4.137142, 1.216917, 1.341929]

    data = dataframe[feats].values
    x = data[0]-mean
    # print(x)
    np.seterr(invalid='ignore')
    np.seterr(divide='ignore', invalid='ignore')
    x = np.divide(x, std)
    # print(x)
    where_are_NaNs = np.isnan(x)
    x[where_are_NaNs] = 0
    where_are_inf = np.isinf(x)
    x[where_are_inf] = 0
    # print("x: ", x)
    for model in models:
        saved_model = joblib.load(model + '.pkl')
        y_pred = saved_model.predict([x])[0]
        y_pred = int(y_pred)
        print(model, ': ', y_pred)
        results.append(y_pred)
        # results = st.mode(results).mode[0]
    return results

def final(results, models):
    weights = {'AB_model':2, 'DT_model':3, 'GB_model':7,'KN_model':6, 'LDA_model':6, 'RF_model':6, 'SVM_model':7,'EDA_AB_model':1,
               'EDA_DT_model':1, 'EDA_KN_model':1, 'EDA_GB_model':1, 'EDA_LDA_model':1, 'EDA_RF_model':1, 'EDA_SVM_model':1}
    total = 0
    tot_weights = 0
    for i in range(len(results)):
        total += weights[models[i]] * results[i]
        tot_weights += weights[models[i]]
    threshold = tot_weights/2
    print("Total: ", total)
    print("Threshold: ", threshold)
    if total > threshold:
        return 1, total, threshold
    else:
        return 0, total, threshold


def get_samples(data, label, ma_usage):
    global feat_names
    WINDOW_IN_SECONDS = 40
    ENSEMBLE = True
    samples = []

    # 64*60 , sliding window: 0.25 sec (60*0.25 = 15)
    window_len = fs_dict_BVP * WINDOW_IN_SECONDS
    sliding_window_len = int(fs_dict_BVP * WINDOW_IN_SECONDS * 0.25)

    winNum = 0
    method = True

    i = 0
    while sliding_window_len * i <= len(data) - window_len:

        # Include all windows corresponding to one window
        w = data[sliding_window_len * i: (sliding_window_len * i) + window_len]
        # Calculate stats for window
        wstats = get_window_stats_27_features(ppg_seg=w["BVP"].tolist(), window_length_sec=WINDOW_IN_SECONDS, label=label,
                                              ensemble=ENSEMBLE, ma_usage=True, fs = fs_dict_BVP)
        winNum += 1

        if wstats == []:
            i += 1
            continue
        # Seperating sample and label
        x = pd.DataFrame(wstats, index=[i])

        samples.append(x)
        i += 1
    if samples == []:
        return pd.DataFrame()
    return pd.concat(samples)

def convert_string_to_array(my_string):
    my_list = list(map(float, my_string.strip('[]').split(',')))
    my_array = np.array(my_list)
    return my_array

def create_data(ppg_data, device, fs_dict_BVP, eda_data = [], fs_dict_EDA = 4):
    if device == 1:
        data = convert_string_to_array(ppg_data)
        length = len(data)
        # Define the original sampling rate
        original_sampling_rate = int(length / 90)

        # Define the new sampling rate
        new_sampling_rate = fs_dict_BVP

        # Define the cutoff frequency of the low-pass filter
        cutoff_frequency = 11
        

        # Apply a low-pass filter to the original signal
        b, a = signal.butter(4, cutoff_frequency / (0.5 * new_sampling_rate), 'low')
        filtered_signal = signal.filtfilt(b, a, data)

        # Calculate the resampling factor
        resampling_factor = new_sampling_rate / original_sampling_rate

        # Calculate the new length of the signal
        new_length = int(len(data) * resampling_factor)

        # Resample the filtered signal
        df_BVP = signal.resample(filtered_signal, new_length)

        return df_BVP

    elif device == 2:
        ppg_data = convert_string_to_array(ppg_data)
        eda_data = convert_string_to_array(eda_data)
        # length = len(ppg_data)
        # # Define the original sampling rate
        # original_sampling_rate = int(length / 90)
        #
        # # Define the new sampling rate
        # new_sampling_rate = fs_dict_BVP
        #
        # # Define the cutoff frequency of the low-pass filter
        # cutoff_frequency = 11
        #
        # # Apply a low-pass filter to the original signal
        # b, a = signal.butter(4, cutoff_frequency / (0.5 * new_sampling_rate), 'low')
        # filtered_signal = signal.filtfilt(b, a, ppg_data)
        #
        # # Calculate the resampling factor
        # resampling_factor = new_sampling_rate / original_sampling_rate
        #
        # # Calculate the new length of the signal
        # new_length = int(len(ppg_data) * resampling_factor)

        # Resample the filtered signal
        # df_BVP = signal.resample(filtered_signal, new_length)
        return ppg_data, eda_data

def is_stressed(raw_ppg, raw_eda, clear_siganl_begining, device = 1):
    if device == 1:
        fs_dict_BVP = 64  # frequency

        raw_ppg = create_data(raw_ppg, device, fs_dict_BVP)

        cycle = 15
        temp_ths = [1.0, 2.0, 1.8, 1.5]  # std_, kurt, skews

        models = ['AB_model', 'DT_model',  'KN_model', 'GB_model',
                  'LDA_model', 'RF_model', 'SVM_model']

        feats = ['HR_mean', 'HR_std', 'meanNN', 'SDNN', 'medianNN', 'meanSD', 'SDSD', 'RMSSD', 'pNN20', 'pNN50', 'TINN',
                 'LF', 'HF', 'ULF', 'VLF', 'LFHF',
                 'total_power', 'lfp', 'hfp', 'SD1', 'SD2', 'pA', 'pQ', 'ApEn', 'shanEn', 'D2']

        # Standardize
        mean = np.mean(raw_ppg)
        std = np.std(raw_ppg)
        ppg_data = ((raw_ppg - mean) / std)[64:-32]
        # print(data)

        # Signal preprocessing

        # Bp
        bp_bvp = butter_bandpassfilter(ppg_data, 0.5, 10, fs_dict_BVP, order=2)

        # Time
        fwd = moving_average(bp_bvp, size=3)
        bwd = moving_average(bp_bvp[::-1], size=3)
        bp_bvp = np.mean(np.vstack((fwd, bwd[::-1])), axis=0)

        signal_5_percent = int(len(bp_bvp) * 0.05)
        # print(signal_5_percent)
        clean_signal = bp_bvp[clear_siganl_begining:
                              clear_siganl_begining + signal_5_percent]
        ths = statistic_threshold(clean_signal, fs_dict_BVP, temp_ths)
        len_before, len_after, time_signal_index = eliminate_noise_in_time(
            bp_bvp, fs_dict_BVP, ths, cycle)
        # print('len_before ', len_before, ' len_after ', len_after)
        # print(time_signal_index)
        df = pd.DataFrame(bp_bvp, columns=['BVP'])

        df = df.iloc[time_signal_index, :]
        df = df.reset_index(drop=True)

        # plt.plot(df)
        # plt.show()

        features_of_windows = get_samples(df, 0, True)
        if features_of_windows.empty:
            return [2, 0, 0, 0]
        features = features_of_windows.mean().transpose()
        print("features: ", features)
        ppg_res = PPG_ML_output(features, feats, models)
        # ppg_res = st.mode(ppg_res).mode[0]
        results = ppg_res
        final_res, total, threshold = final(results, models)
        print(final_res)
    elif device == 2:
        fs_dict_BVP = 64  # ppg frequency
        fs_dict_EDA = 4  # eda frequency
        raw_ppg, raw_eda = create_data(raw_ppg, device, fs_dict_BVP, raw_eda, fs_dict_EDA)

        #EDA

        eda_models = ['EDA_AB_model', 'EDA_DT_model', 'EDA_KN_model', 'EDA_GB_model',
                  'EDA_LDA_model', 'EDA_RF_model', 'EDA_SVM_model']

        eda_feats = ['number_of_peaks', 'mean_gsr', 'max_of_peaks']

        mean_eda = np.mean(raw_eda)
        std_eda = np.std(raw_eda)
        eda_data = ((raw_eda - mean_eda) / std_eda)[4:]

        # print(raw_eda)
        m, wd, eda_clean = process_statistical(eda_data, use_scipy=True, sample_rate=4,
                                               new_sample_rate=4, segment_width=40,
                                               segment_overlap=0)

        eda_features = pd.DataFrame(columns=['number_of_peaks', 'mean_gsr', 'max_of_peaks'])
        for i in range(len(m['segment_indices'])):
            eda_features = eda_features.append(
                {'number_of_peaks': m['number_of_peaks'][i], 'mean_gsr': m['mean_gsr'][i],
                 'max_of_peaks': m['max_of_peaks'][i]}, ignore_index=True)

        # print(eda_features)
        if eda_features.empty:
            return [2, 0, 0, 0]
        eda_features = eda_features.mean().transpose()
        print("features: ", eda_features)
        eda_res = EDA_ML_output(eda_features, eda_feats, eda_models)
        print(eda_res)



        #PPG

        cycle = 15
        # cycle = 15
        temp_ths = [1.0, 2.0, 1.8, 1.5]  # std_, kurt, skews

        models = ['AB_model', 'DT_model', 'KN_model', 'GB_model',
                  'LDA_model', 'RF_model', 'SVM_model']

        feats = ['HR_mean', 'HR_std', 'meanNN', 'SDNN', 'medianNN', 'meanSD', 'SDSD', 'RMSSD', 'pNN20', 'pNN50', 'TINN',
                 'LF', 'HF', 'ULF', 'VLF', 'LFHF',
                 'total_power', 'lfp', 'hfp', 'SD1', 'SD2', 'pA', 'pQ', 'ApEn', 'shanEn', 'D2']

        # Standardize
        mean = np.mean(raw_ppg)
        std = np.std(raw_ppg)
        ppg_data = ((raw_ppg - mean) / std)[64:-32]
        # print(data)

        # Signal preprocessing

        # Bp
        bp_bvp = butter_bandpassfilter(ppg_data, 0.5, 10, fs_dict_BVP, order=2)

        # Time
        fwd = moving_average(bp_bvp, size=3)
        bwd = moving_average(bp_bvp[::-1], size=3)
        bp_bvp = np.mean(np.vstack((fwd, bwd[::-1])), axis=0)

        signal_5_percent = int(len(bp_bvp) * 0.05)
        print(signal_5_percent)
        clean_signal = bp_bvp[clear_siganl_begining:
                              clear_siganl_begining + signal_5_percent]
        # clean_signal = [0.3535533905932738, 0.5137519464808332, 0.6570300882717717, 0.7806773174560775, 0.8826834323650898,
        #  0.9617893770276129, 1.0175099992752457, 1.0501280903149182, 1.0606601717798214, 1.050795569872538,
        #  1.0228113284850902, 0.9794664253564193, 0.9238795325112868, 0.8593951747241447, 0.7894435642206856,
        #  0.7173996101623958, 0.6464466094067263, 0.5794499205209243, 0.5188455141475872, 0.4665476955305938,
        #  0.42387953251128674, 0.39152862414673983, 0.36952984604690187, 0.3572756472114644, 0.35355339059327373,
        #  0.3566081676538444, 0.36422851683705737, 0.37385157581793343, 0.3826834323650898, 0.3878298382625265,
        #  0.38643203819867317, 0.37580225683936175, 0.3535533905932738, 0.317717665821712, 0.26684944423951507,
        #  0.20010796294715305, 0.11731656763491033, 0.018995903375617518, -0.09363046676395859, -0.21865847801237248,
        #  -0.3535533905932733, -0.49522533685293474, -0.6401278961200008, -0.784376103340291, -0.9238795325112863,
        #  -1.0544854967402724, -1.1721269965857744, -1.2729698431819985, -1.353553390593274, -1.4109195328234696,
        #  -1.4427250466588737, -1.447332975933824, -1.4238795325112865, -1.3723139045499702, -1.2934093785581888,
        #  -1.1887452595140098, -1.0606601717798219, -0.9121784006734479, -0.7469119492021467, -0.5689418978340619,
        #  -0.3826834323650906, -0.19273951624639893, -0.0037486058335846895, 0.17976797618024104, 0.3535533905932737,
        #  0.5137519464808326, 0.6570300882717715, 0.780677317456077, 0.88268343236509, 0.9617893770276127,
        #  1.0175099992752452, 1.0501280903149184, 1.0606601717798216, 1.0507955698725384, 1.0228113284850897,
        #  0.9794664253564189, 0.9238795325112868, 0.8593951747241453, 0.7894435642206863, 0.7173996101623954,
        #  0.6464466094067262, 0.5794499205209245, 0.5188455141475875, 0.46654769553059333, 0.42387953251128674,
        #  0.39152862414674, 0.36952984604690214, 0.35727564721146465, 0.353553390593274, 0.3566081676538448,
        #  0.3642285168370577, 0.3738515758179339, 0.3826834323650901, 0.38782983826252687, 0.38643203819867356,
        #  0.3758022568393621, 0.3535533905932742, 0.31771766582171257, 0.2668494442395159, 0.2001079629471526,
        #  0.11731656763491016, 0.018995903375617795, -0.09363046676395831, -0.21865847801237193, -0.3535533905932748,
        #  -0.49522533685293646, -0.6401278961200004, -0.7843761033402906, -0.923879532511286, -1.054485496740272,
        #  -1.1721269965857761, -1.2729698431819982, -1.3535533905932737, -1.4109195328234694, -1.442725046658874,
        #  -1.447332975933824, -1.4238795325112867, -1.3723139045499704, -1.293409378558189, -1.1887452595140104,
        #  -1.0606601717798227, -0.9121784006734461, -0.7469119492021471, -0.5689418978340625, -0.3826834323650911,
        #  -0.19273951624640023, -0.0037486058335826355, 0.1797679761802406, 0.35355339059327323, 0.5137519464808322,
        #  0.6570300882717702, 0.7806773174560779, 0.8826834323650897, 0.9617893770276125, 1.0175099992752452,
        #  1.0501280903149177, 1.060660171779821, 1.0507955698725377, 1.0228113284850897, 0.979466425356419,
        #  0.923879532511287, 0.8593951747241453, 0.7894435642206851, 0.7173996101623955, 0.6464466094067263,
        #  0.5794499205209246, 0.5188455141475876, 0.4665476955305935, 0.42387953251128685, 0.39152862414674006,
        #  0.36952984604690214, 0.35727564721146465, 0.35355339059327406, 0.35660816765384473, 0.3642285168370577,
        #  0.3738515758179338, 0.3826834323650901, 0.38782983826252687, 0.38643203819867356, 0.37580225683936064,
        #  0.353553390593273, 0.3177176658217117, 0.2668494442395154, 0.20010796294715383, 0.11731656763491205,
        #  0.018995903375620293, -0.09363046676395942, -0.21865847801237287, -0.3535533905932732, -0.4952253368529346,
        #  -0.6401278961199985, -0.7843761033402885, -0.9238795325112839, -1.05448549674027, -1.1721269965857721,
        #  -1.272969843181995, -1.353553390593271, -1.4109195328234692, -1.4427250466588735, -1.4473329759338238,
        #  -1.423879532511287, -1.3723139045499708, -1.2934093785581902, -1.1887452595140118, -1.0606601717798245,
        #  -0.9121784006734508, -0.7469119492021523, -0.5689418978340613, -0.38268343236508995, -0.192739516246399,
        #  -0.003748605833584745, 0.17976797618023865, 0.35355339059327157, 0.5137519464808308, 0.6570300882717692,
        #  0.7806773174560753, 0.8826834323650878, 0.9617893770276115, 1.0175099992752465, 1.050128090314919,
        #  1.0606601717798223, 1.0507955698725393, 1.0228113284850915, 0.9794664253564209, 0.9238795325112888,
        #  0.8593951747241471, 0.7894435642206882, 0.7173996101623985, 0.6464466094067265, 0.5794499205209246,
        #  0.5188455141475874, 0.4665476955305939, 0.42387953251128685, 0.3915286241467398, 0.3695298460469015,
        #  0.35727564721146376, 0.3535533905932729, 0.3566081676538431, 0.3642285168370558, 0.37385157581793227,
        #  0.3826834323650885, 0.38782983826252515, 0.3864320381986719, 0.37580225683936064, 0.353553390593273,
        #  0.3177176658217118, 0.2668494442395155, 0.20010796294715405, 0.11731656763491227, 0.01899590337562057,
        #  -0.09363046676395909, -0.21865847801237254, -0.35355339059327284, -0.49522533685293424, -0.6401278961199981,
        #  -0.7843761033402882, -0.9238795325112836, -1.0544854967402695, -1.172126996585772, -1.2729698431819947,
        #  -1.3535533905932708, -1.410919532823469, -1.4427250466588735, -1.4473329759338238, -1.423879532511287,
        #  -1.372313904549971, -1.2934093785581902, -1.188745259514012, -1.0606601717798247, -0.9121784006734512,
        #  -0.7469119492021528, -0.5689418978340618, -0.38268343236509045, -0.19273951624639948, -0.003748605833585217,
        #  0.17976797618023824, 0.3535533905932711, 0.5137519464808304, 0.6570300882717688, 0.780677317456075,
        #  0.8826834323650876, 0.9617893770276114, 1.0175099992752465, 1.050128090314919, 1.0606601717798223,
        #  1.0507955698725393, 1.0228113284850917, 0.979466425356421, 0.923879532511289, 0.8593951747241473,
        #  0.7894435642206883, 0.7173996101623987, 0.6464466094067267, 0.5794499205209247, 0.5188455141475876,
        #  0.46654769553059405, 0.42387953251128696, 0.39152862414673983, 0.36952984604690153, 0.3572756472114637,
        #  0.3535533905932728, 0.3566081676538431, 0.3642285168370558, 0.37385157581793227, 0.38268343236508845,
        #  0.38782983826252515, 0.38643203819867195, 0.37580225683936075, 0.3535533905932731, 0.3177176658217119,
        #  0.2668494442395157, 0.20010796294715422, 0.1173165676349125, 0.01899590337562085, -0.09363046676395892,
        #  -0.21865847801237226, -0.35355339059327245, -0.49522533685293385, -0.6401278961199977, -0.7843761033402877,
        #  -0.9238795325112833, -1.0544854967402693, -1.1721269965857715, -1.2729698431819945, -1.3535533905932708,
        #  -1.4109195328234687, -1.4427250466588732, -1.4473329759338238, -1.423879532511287, -1.3723139045499713,
        #  -1.2934093785581904, -1.1887452595140124, -1.0606601717798252, -0.9121784006734517, -0.7469119492021532,
        #  -0.5689418978340622, -0.3826834323650909, -0.19273951624639996, -0.003748605833585661, 0.17976797618023777,
        #  0.35355339059327073, 0.51375194648083, 0.6570300882717686, 0.7806773174560755, 0.8826834323650874,
        #  0.9617893770276105, 1.0175099992752448, 1.0501280903149188, 1.0606601717798223, 1.0507955698725393,
        #  1.022811328485093, 0.9794664253564211, 0.9238795325112871, 0.8593951747241475, 0.789443564220686,
        #  0.717399610162399, 0.6464466094067268, 0.5794499205209273, 0.5188455141475877, 0.4665476955305959,
        #  0.42387953251128707, 0.39152862414674083, 0.36952984604690164, 0.35727564721146343, 0.35355339059327273,
        #  0.35660816765384334, 0.3642285168370558, 0.37385157581793227, 0.38268343236508817, 0.38782983826252515,
        #  0.3864320381986721, 0.37580225683936075, 0.35355339059327423, 0.317717665821712, 0.2668494442395136,
        #  0.20010796294715438, 0.11731656763490944, 0.018995903375621126, -0.09363046676395859, -0.21865847801236715,
        #  -0.35355339059327207, -0.49522533685292836, -0.6401278961199974, -0.7843761033402926, -0.9238795325112829,
        #  -1.0544854967402735, -1.1721269965857712, -1.2729698431819976, -1.3535533905932706, -1.4109195328234687,
        #  -1.4427250466588726, -1.4473329759338238, -1.4238795325112885, -1.3723139045499715, -1.2934093785581873,
        #  -1.1887452595140127, -1.0606601717798205, -0.912178400673452, -0.7469119492021473, -0.5689418978340693,
        #  -0.38268343236509134, -0.19273951624640734, -0.0037486058335861328, 0.17976797618023083, 0.35355339059327034,
        #  0.5137519464808352, 0.6570300882717682, 0.7806773174560786, 0.8826834323650872, 0.9617893770276134,
        #  1.0175099992752445, 1.0501280903149188, 1.0606601717798223, 1.0507955698725393, 1.0228113284850933,
        #  0.9794664253564214, 0.9238795325112872, 0.8593951747241476, 0.7894435642206862, 0.7173996101623991,
        #  0.6464466094067269, 0.5794499205209274, 0.5188455141475878, 0.46654769553059605, 0.4238795325112872,
        #  0.39152862414674094, 0.36952984604690164, 0.35727564721146343, 0.3535533905932728, 0.35660816765384334,
        #  0.3642285168370558, 0.3738515758179322, 0.3826834323650881, 0.38782983826252515, 0.38643203819867217,
        #  0.37580225683936075, 0.35355339059327223, 0.3177176658217121, 0.26684944423951384, 0.20010796294715455,
        #  0.11731656763490966, 0.018995903375621348, -0.09363046676395825, -0.21865847801236693, -0.3535533905932718,
        #  -0.4952253368529279, -0.640127896119997, -0.7843761033402922, -0.9238795325112825, -1.054485496740273,
        #  -1.172126996585771, -1.2729698431819974, -1.3535533905932704, -1.4109195328234687, -1.4427250466588726,
        #  -1.4473329759338238, -1.4238795325112887, -1.3723139045499715, -1.2934093785581875, -1.1887452595140129,
        #  -1.0606601717798207, -0.9121784006734523, -0.7469119492021478, -0.5689418978340698, -0.38268343236509184,
        #  -0.19273951624640778, -0.0037486058335866046, 0.17976797618023038, 0.3535533905932699, 0.5137519464808348,
        #  0.6570300882717679, 0.7806773174560783, 0.882683432365087, 0.9617893770276132, 1.0175099992752443,
        #  1.0501280903149186, 1.0606601717798223, 1.0507955698725393, 1.0228113284850933, 0.9794664253564215,
        #  0.9238795325112873, 0.8593951747241478, 0.7894435642206863, 0.7173996101623993, 0.6464466094067272,
        #  0.5794499205209276, 0.518845514147588, 0.4665476955305961, 0.4238795325112873, 0.391528624146741,
        #  0.3695298460469017, 0.35727564721146354, 0.35355339059327284, 0.35660816765384323, 0.3642285168370558,
        #  0.3738515758179322, 0.3826834323650881, 0.38782983826252515, 0.38643203819867217, 0.37580225683936086,
        #  0.3535533905932744, 0.31771766582171224, 0.26684944423951396, 0.20010796294715472, 0.11731656763490989,
        #  0.018995903375621626, -0.09363046676395792, -0.2186584780123666, -0.3535533905932714, -0.49522533685292763,
        #  -0.6401278961199967, -0.7843761033402918, -0.9238795325112822, -1.0544854967402728, -1.1721269965857708,
        #  -1.2729698431819971, -1.3535533905932702, -1.4109195328234685, -1.4427250466588726, -1.4473329759338238,
        #  -1.4238795325112887, -1.3723139045499717, -1.293409378558188, -1.1887452595140133, -1.0606601717798212,
        #  -0.9121784006734528, -0.7469119492021483, -0.5689418978340702, -0.3826834323650923, -0.19273951624640828,
        #  -0.0037486058335870764, 0.17976797618022994, 0.35355339059326946, 0.5137519464808344, 0.6570300882717676,
        #  0.7806773174560779, 0.8826834323650867, 0.9617893770276131, 1.0175099992752443, 1.0501280903149186,
        #  1.0606601717798223, 1.0507955698725393, 1.0228113284850933, 0.9794664253564216, 0.9238795325112874,
        #  0.859395174724148, 0.7894435642206865, 0.7173996101623995, 0.6464466094067274, 0.5794499205209277,
        #  0.5188455141475881, 0.4665476955305962, 0.4238795325112874, 0.39152862414674106, 0.3695298460469017,
        #  0.3572756472114635, 0.3535533905932728, 0.3566081676538433, 0.3642285168370557, 0.37385157581793216,
        #  0.38268343236508806, 0.38782983826252515, 0.3864320381986722, 0.37580225683936086, 0.3535533905932724,
        #  0.31771766582171235, 0.26684944423951407, 0.200107962947155, 0.11731656763491011, 0.018995903375621903,
        #  -0.09363046676395764, -0.2186584780123662, -0.3535533905932711, -0.4952253368529273, -0.6401278961199962,
        #  -0.7843761033402914, -0.9238795325112819, -1.0544854967402726, -1.1721269965857704, -1.272969843181997,
        #  -1.35355339059327, -1.4109195328234683, -1.4427250466588724, -1.447332975933824, -1.4238795325112887,
        #  -1.372313904549972, -1.293409378558188, -1.1887452595140136, -1.0606601717798214, -0.9121784006734532,
        #  -0.7469119492021488, -0.5689418978340707, -0.3826834323650928, -0.19273951624640873, -0.0037486058335875483,
        #  0.1797679761802295, 0.353553390593269, 0.513751946480834, 0.6570300882717672, 0.7806773174560777,
        #  0.8826834323650865, 0.9617893770276129, 1.0175099992752443, 1.0501280903149186, 1.0606601717798223,
        #  1.0507955698725395, 1.0228113284850935, 0.9794664253564217, 0.9238795325112875, 0.8593951747241481,
        #  0.7894435642206867, 0.7173996101623996, 0.6464466094067276, 0.5794499205209278, 0.5188455141475883,
        #  0.4665476955305964, 0.4238795325112874, 0.3915286241467411, 0.3695298460469018, 0.3572756472114636,
        #  0.35355339059327284, 0.3566081676538433, 0.3642285168370557, 0.3738515758179321, 0.38268343236508806,
        #  0.38782983826252515, 0.3864320381986722, 0.3758022568393609, 0.3535533905932745, 0.31771766582171246,
        #  0.2668494442395143, 0.20010796294715516, 0.11731656763491033, 0.01899590337562218, -0.09363046676395731,
        #  -0.218658478012366, -0.35355339059327073, -0.49522533685292686, -0.6401278961199959, -0.7843761033402911,
        #  -0.9238795325112814, -1.0544854967402721, -1.1721269965857701, -1.2729698431819965, -1.35355339059327,
        #  -1.4109195328234683, -1.4427250466588726, -1.447332975933824, -1.4238795325112887, -1.3723139045499722,
        #  -1.2934093785581882, -1.1887452595140138, -1.0606601717798219, -0.9121784006734535, -0.7469119492021492,
        #  -0.5689418978340711, -0.3826834323650932, -0.19273951624640923, -0.0037486058335879924, 0.17976797618022902,
        #  0.3535533905932686, 0.5137519464808337, 0.6570300882717668, 0.7806773174560775, 0.8826834323650863,
        #  0.9617893770276127, 1.017509999275244, 1.0501280903149186, 1.0606601717798223, 1.0507955698725338,
        #  1.022811328485087, 0.9794664253564218, 0.9238795325112922, 0.8593951747241434, 0.7894435642206868,
        #  0.7173996101623998, 0.6464466094067327, 0.5794499205209234, 0.5188455141475885, 0.46654769553059644,
        #  0.4238795325112903, 0.3915286241467392, 0.36952984604690187, 0.35727564721146415, 0.3535533905932728,
        #  0.3566081676538433, 0.3642285168370557, 0.3738515758179314, 0.3826834323650886, 0.38782983826252515,
        #  0.3864320381986722, 0.3758022568393621, 0.3535533905932725, 0.3177176658217125, 0.2668494442395187,
        #  0.20010796294714994, 0.11731656763491055, 0.018995903375622458, -0.09363046676394837, -0.21865847801237498,
        #  -0.3535533905932704, -0.4952253368529266, -0.6401278961199851, -0.7843761033402907, -0.9238795325112812,
        #  -1.0544854967402628, -1.172126996585778, -1.2729698431819965, -1.3535533905932697, -1.410919532823465,
        #  -1.4427250466588737, -1.447332975933824, -1.423879532511289, -1.372313904549977, -1.2934093785581886,
        #  -1.1887452595140142, -1.0606601717798323, -0.9121784006734426, -0.7469119492021494, -0.5689418978340717,
        #  -0.38268343236510743, -0.1927395162463959, -0.0037486058335884642, 0.1797679761802286, 0.3535533905932561,
        #  0.5137519464808333, 0.6570300882717666, 0.780677317456069, 0.8826834323650926, 0.9617893770276126,
        #  1.0175099992752439, 1.050128090314917, 1.0606601717798223, 1.0507955698725395, 1.0228113284850937,
        #  0.9794664253564184, 0.9238795325112878, 0.8593951747241485, 0.7894435642206922, 0.7173996101623947,
        #  0.6464466094067278, 0.5794499205209283, 0.5188455141475927, 0.4665476955305931, 0.4238795325112876,
        #  0.3915286241467412, 0.3695298460469006, 0.35727564721146365, 0.35355339059327284, 0.35660816765384284,
        #  0.36422851683705637, 0.37385157581793205, 0.382683432365088, 0.38782983826252493, 0.38643203819867183,
        #  0.37580225683936097, 0.3535533905932747, 0.3177176658217095, 0.2668494442395145, 0.2001079629471555,
        #  0.11731656763491738, 0.018995903375615075, -0.09363046676395681, -0.21865847801236526, -0.35355339059326,
        #  -0.49522533685293657, -0.6401278961199952, -0.7843761033402801, -0.9238795325112906, -1.0544854967402715,
        #  -1.1721269965857697, -1.2729698431819896, -1.3535533905932744, -1.410919532823468, -1.4427250466588724,
        #  -1.4473329759338247, -1.4238795325112863, -1.3723139045499724, -1.2934093785581953, -1.188745259514006,
        #  -1.0606601717798225, -0.9121784006734543, -0.7469119492021624, -0.5689418978340588, -0.38268343236509417,
        #  -0.19273951624641017, -0.003748605833602481, 0.1797679761802411, 0.3535533905932678, 0.5137519464808219,
        #  0.6570300882717759, 0.7806773174560768, 0.8826834323650858, 0.9617893770276076, 1.017509999275247,
        #  1.0501280903149186, 1.0606601717798223, 1.050795569872541, 1.022811328485091, 0.979466425356422,
        #  0.9238795325112924, 0.8593951747241437, 0.7894435642206872, 0.7173996101624002, 0.6464466094067332,
        #  0.5794499205209238, 0.5188455141475887, 0.46654769553059666, 0.4238795325112904, 0.39152862414673933,
        #  0.36952984604690187, 0.3572756472114641, 0.3535533905932728, 0.35660816765384323, 0.3642285168370557,
        #  0.3738515758179314, 0.38268343236508856, 0.38782983826252515, 0.3864320381986722, 0.3758022568393622,
        #  0.3535533905932727, 0.3177176658217128, 0.26684944423951895, 0.20010796294715028, 0.117316567634911,
        #  0.018995903375622958, -0.09363046676394787, -0.21865847801237437, -0.35355339059326973, -0.4952253368529258,
        #  -0.6401278961199843, -0.7843761033402901, -0.9238795325112805, -1.0544854967402622, -1.1721269965857772,
        #  -1.272969843181996, -1.3535533905932693, -1.4109195328234647, -1.4427250466588735, -1.447332975933824,
        #  -1.4238795325112892, -1.3723139045499773, -1.2934093785581888, -1.1887452595140147, -1.060660171779833,
        #  -0.9121784006734434, -0.7469119492021503, -0.5689418978340725, -0.3826834323651083, -0.1927395162463969,
        #  -0.003748605833589408, 0.17976797618022766, 0.3535533905932795, 0.5137519464808326, 0.6570300882717659,
        #  0.7806773174560684, 0.8826834323650922, 0.9617893770276122, 1.0175099992752437, 1.0501280903149168,
        #  1.0606601717798223, 1.0507955698725397, 1.0228113284850937, 0.9794664253564186, 0.9238795325112882,
        #  0.8593951747241488, 0.7894435642206925, 0.7173996101623952, 0.6464466094067283, 0.5794499205209285,
        #  0.518845514147593, 0.46654769553059344, 0.42387953251128785, 0.3915286241467414, 0.36952984604690076,
        #  0.3572756472114636, 0.3535533905932728, 0.3566081676538428, 0.36422851683705626, 0.37385157581793205,
        #  0.382683432365088, 0.387829838262525, 0.3864320381986719, 0.3758022568393611, 0.35355339059327484,
        #  0.31771766582170974, 0.26684944423951484, 0.20010796294715588, 0.11731656763491782, 0.01899590337561552,
        #  -0.09363046676395614, -0.21865847801236465, -0.35355339059325935, -0.49522533685293585, -0.6401278961199944,
        #  -0.7843761033402794, -0.9238795325112901, -1.054485496740271, -1.172126996585769, -1.2729698431819891,
        #  -1.3535533905932742, -1.4109195328234678, -1.4427250466588721, -1.4473329759338247, -1.4238795325112865,
        #  -1.3723139045499728, -1.293409378558196, -1.1887452595140067, -1.0606601717798232, -0.9121784006734551,
        #  -0.7469119492021633, -0.5689418978340597, -0.3826834323650951, -0.19273951624641117, -0.0037486058336033967,
        #  0.1797679761802402, 0.35355339059326696, 0.5137519464808211, 0.6570300882717752, 0.7806773174560763,
        #  0.8826834323650854, 0.9617893770276071, 1.017509999275247, 1.0501280903149184, 1.0606601717798223,
        #  1.050795569872541, 1.0228113284850913, 0.9794664253564224, 0.9238795325112926, 0.8593951747241441,
        #  0.7894435642206875, 0.7173996101624005, 0.6464466094067334, 0.579449920520924, 0.518845514147589,
        #  0.466547695530597, 0.4238795325112906, 0.3915286241467395, 0.36952984604690203, 0.35727564721146415,
        #  0.35355339059327284, 0.3566081676538432, 0.3642285168370556, 0.3738515758179313, 0.3826834323650885,
        #  0.3878298382625251, 0.3864320381986723, 0.3758022568393623, 0.35355339059327284, 0.317717665821713,
        #  0.26684944423951923, 0.2001079629471506, 0.1173165676349115, 0.018995903375623457, -0.09363046676394726,
        #  -0.2186584780123737, -0.35355339059326907, -0.4952253368529251, -0.6401278961199837, -0.7843761033402893,
        #  -0.9238795325112797, -1.0544854967402617, -1.1721269965857768, -1.2729698431819956, -1.353553390593269,
        #  -1.4109195328234645, -1.4427250466588735, -1.447332975933824, -1.4238795325112892, -1.3723139045499777,
        #  -1.2934093785581893, -1.1887452595140153, -1.0606601717798336, -0.9121784006734441, -0.7469119492021513,
        #  -0.5689418978340735, -0.38268343236510927, -0.19273951624639782, -0.0037486058335903516, 0.1797679761802268,
        #  0.3535533905932544, 0.5137519464808318, 0.6570300882717652, 0.7806773174560678, 0.8826834323650917,
        #  0.9617893770276118, 1.0175099992752437, 1.0501280903149168, 1.0606601717798223, 1.0507955698725397,
        #  1.022811328485094, 0.9794664253564188, 0.9238795325112885, 0.8593951747241492, 0.7894435642206928,
        #  0.7173996101623954, 0.6464466094067285, 0.5794499205209289, 0.5188455141475932, 0.46654769553059366,
        #  0.42387953251128807, 0.3915286241467415, 0.36952984604690076, 0.35727564721146365, 0.3535533905932728,
        #  0.35660816765384284, 0.36422851683705626, 0.373851575817932, 0.382683432365088, 0.38782983826252493,
        #  0.3864320381986719, 0.37580225683936114, 0.35355339059327495, 0.31771766582170996, 0.2668494442395152,
        #  0.20010796294715627, 0.11731656763491827, 0.018995903375616074, -0.09363046676395553, -0.21865847801236393,
        #  -0.3535533905932585, -0.4952253368529351, -0.6401278961199938, -0.7843761033402787, -0.9238795325112893,
        #  -1.0544854967402704, -1.1721269965857686, -1.2729698431819887, -1.353553390593274, -1.4109195328234676,
        #  -1.4427250466588721, -1.4473329759338247, -1.4238795325112867, -1.372313904549973, -1.2934093785581964,
        #  -1.1887452595140071, -1.0606601717798239, -0.9121784006734559, -0.7469119492021642, -0.5689418978340607,
        #  -0.3826834323650961, -0.19273951624641206, -0.0037486058336043404, 0.17976797618023935, 0.3535533905932661,
        #  0.5137519464808203, 0.6570300882717746, 0.7806773174560757, 0.882683432365085, 0.9617893770276069,
        #  1.0175099992752465, 1.0501280903149182, 1.0606601717798223, 1.0507955698725413, 1.0228113284850915,
        #  0.9794664253564226, 0.9238795325112931, 0.8593951747241445, 0.7894435642206878, 0.717399610162401,
        #  0.6464466094067338, 0.5794499205209244, 0.5188455141475892, 0.46654769553059716, 0.42387953251129085,
        #  0.3915286241467396, 0.36952984604690203, 0.3572756472114642, 0.35355339059327273, 0.3566081676538432,
        #  0.3642285168370556, 0.3738515758179312, 0.3826834323650885, 0.3878298382625251, 0.38643203819867233,
        #  0.37580225683936236, 0.35355339059327295, 0.31771766582171324, 0.2668494442395195, 0.20010796294715105,
        #  0.11731656763491194, 0.018995903375624013, -0.0936304667639466, -0.2186584780123731, -0.3535533905932683,
        #  -0.49522533685292436, -0.6401278961199829, -0.7843761033402886, -0.9238795325112792, -1.054485496740261,
        #  -1.1721269965857763, -1.2729698431819951, -1.3535533905932686, -1.4109195328234643, -1.4427250466588735,
        #  -1.4473329759338243, -1.4238795325112896, -1.372313904549978, -1.29340937855819, -1.188745259514016,
        #  -1.0606601717798343, -0.9121784006734449, -0.7469119492021521, -0.5689418978340743, -0.3826834323651102,
        #  -0.1927395162463988, -0.0037486058335912675, 0.17976797618022594, 0.35355339059327784, 0.513751946480831,
        #  0.6570300882717646, 0.7806773174560673, 0.8826834323650912, 0.9617893770276116, 1.0175099992752434,
        #  1.0501280903149166, 1.0606601717798223, 1.05079556987254, 1.0228113284850942, 0.9794664253564191,
        #  0.9238795325112887, 0.8593951747241495, 0.7894435642206934, 0.7173996101623958, 0.6464466094067289,
        #  0.5794499205209291, 0.5188455141475935, 0.46654769553059383, 0.4238795325112882, 0.3915286241467416,
        #  0.3695298460469009, 0.3572756472114637, 0.3535533905932728, 0.35660816765384273, 0.36422851683705626,
        #  0.37385157581793194, 0.38268343236508795, 0.38782983826252493, 0.3864320381986719, 0.37580225683936125,
        #  0.3535533905932751, 0.3177176658217101, 0.2668494442395154, 0.20010796294715666, 0.11731656763491871,
        #  0.01899590337561663, -0.09363046676395503, -0.21865847801236332, -0.35355339059325797, -0.49522533685293446,
        #  -0.640127896119993, -0.784376103340278, -0.9238795325112886, -1.0544854967402697, -1.1721269965857681,
        #  -1.272969843181988, -1.3535533905932735, -1.4109195328234674, -1.4427250466588721, -1.4473329759338247,
        #  -1.423879532511287, -1.3723139045499733, -1.2934093785581968, -1.1887452595140078, -1.0606601717798247,
        #  -0.9121784006734567, -0.746911949202165, -0.5689418978340616, -0.382683432365097, -0.192739516246413,
        #  -0.003748605833605284, 0.17976797618023843, 0.3535533905932653, 0.5137519464808196, 0.6570300882717739,
        #  0.7806773174560752, 0.8826834323650845, 0.9617893770276065, 1.0175099992752463, 1.0501280903149182,
        #  1.0606601717798223, 1.0507955698725413, 1.0228113284850917, 0.9794664253564227, 0.9238795325112933,
        #  0.8593951747241447, 0.7894435642206883, 0.7173996101624012, 0.646446609406734, 0.5794499205209247,
        #  0.5188455141475895, 0.4665476955305974, 0.42387953251129107, 0.3915286241467397, 0.3695298460469022,
        #  0.35727564721146426, 0.35355339059327284, 0.3566081676538431, 0.36422851683705554, 0.3738515758179312,
        #  0.38268343236508845, 0.3878298382625251, 0.38643203819867233, 0.3758022568393624, 0.3535533905932731,
        #  0.3177176658217134, 0.26684944423951984, 0.20010796294715139, 0.11731656763491238, 0.018995903375624568,
        #  -0.0936304667639461, -0.21865847801237248, -0.3535533905932676, -0.4952253368529236, -0.6401278961199822,
        #  -0.784376103340288, -0.9238795325112785, -1.0544854967402604, -1.1721269965857757, -1.2729698431819945,
        #  -1.3535533905932682, -1.410919532823464, -1.4427250466588732, -1.4473329759338243, -1.4238795325112896,
        #  -1.3723139045499781, -1.2934093785581902, -1.1887452595140164, -1.060660171779835, -0.9121784006734457,
        #  -0.746911949202153, -0.5689418978340752, -0.38268343236511115, -0.19273951624639973, -0.0037486058335921835,
        #  0.179767976180225, 0.35355339059325275, 0.5137519464808302, 0.6570300882717639, 0.7806773174560667,
        #  0.8826834323650907, 0.9617893770276112, 1.017509999275243, 1.0501280903149166, 1.0606601717798223,
        #  1.05079556987254, 1.0228113284850944, 0.9794664253564194, 0.9238795325112891, 0.8593951747241498,
        #  0.7894435642206936, 0.7173996101623962, 0.6464466094067293, 0.5794499205209296, 0.5188455141475938,
        #  0.46654769553059405, 0.4238795325112884, 0.39152862414674183, 0.3695298460469009, 0.35727564721146376,
        #  0.35355339059327273, 0.3566081676538427, 0.36422851683705615, 0.3738515758179319, 0.3826834323650879,
        #  0.38782983826252493, 0.38643203819867195, 0.3758022568393613, 0.35355339059327523, 0.31771766582171035,
        #  0.26684944423951573, 0.200107962947157, 0.11731656763491916, 0.018995903375617185, -0.09363046676395437,
        #  -0.2186584780123626, -0.3535533905932572, -0.49522533685293374, -0.6401278961199923, -0.7843761033402773,
        #  -0.923879532511288, -1.054485496740269, -1.1721269965857675, -1.2729698431819878, -1.353553390593273,
        #  -1.4109195328234674, -1.442725046658872, -1.447332975933825, -1.423879532511287, -1.3723139045499737,
        #  -1.2934093785581973, -1.1887452595140084, -1.0606601717798254, -0.9121784006734575, -0.7469119492021659,
        #  -0.5689418978340625, -0.38268343236509794, -0.19273951624641397, -0.0037486058336062, 0.17976797618023754,
        #  0.35355339059326446, 0.5137519464808189, 0.6570300882717732, 0.7806773174560746, 0.8826834323650841,
        #  0.9617893770276063, 1.017509999275246, 1.0501280903149182, 1.0606601717798223, 1.0507955698725415,
        #  1.0228113284850917, 0.979466425356423, 0.9238795325112936, 0.8593951747241451, 0.7894435642206887,
        #  0.7173996101624016, 0.6464466094067345, 0.579449920520925, 0.5188455141475898, 0.4665476955305977,
        #  0.4238795325112912, 0.39152862414673983, 0.3695298460469077, 0.3572756472114644, 0.35355339059328283,
        #  0.35660816765385495, 0.3642285168370699, 0.3738515758179451, 0.38268343236510266, 0.3878298382625387,
        #  0.3864320381986855, 0.37580225683937196, 0.35355339059328744, 0.3177176658217215, 0.26684944423951706,
        #  0.20010796294716537, 0.11731656763491283, 0.018995903375607026, -0.09363046676395093, -0.21865847801237964,
        #  -0.3535533905932569, -0.4952253368529348, -0.6401278961200155, -0.7843761033402805, -0.923879532511292,
        #  -1.0544854967402917, -1.1721269965857724, -1.272969843182006, -1.3535533905932882, -1.4109195328234718,
        #  -1.4427250466588788, -1.4473329759338283, -1.4238795325112898, -1.3723139045499664, -1.2934093785581986,
        #  -1.1887452595140091, -1.0606601717798056, -0.9121784006734575, -0.7469119492021408, -0.5689418978340358,
        #  -0.3826834323650979, -0.19273951624638674, -0.003748605833607088, 0.17976797618023593, 0.35355339059328617,
        #  0.5137519464808153, 0.6570300882717687, 0.7806773174560853, 0.8826834323650772, 0.961789377027608,
        #  1.0175099992752439, 1.0501280903149086, 1.060660171779812, 1.050795569872531, 1.0228113284850813,
        #  0.9794664253564056, 0.923879532511284, 0.8593951747241363, 0.7894435642206705, 0.7173996101623952,
        #  0.6464466094067196, 0.5794499205209127, 0.5188455141475886, 0.4665476955305916, 0.42387953251129407,
        #  0.3915286241467448, 0.36952984604690653, 0.3572756472114728, 0.3535533905932829, 0.35660816765385533,
        #  0.3642285168370679, 0.37385157581794576, 0.38268343236510316, 0.3878298382625388, 0.3864320381986851,
        #  0.3758022568393755, 0.35355339059328544, 0.3177176658217185, 0.26684944423952994, 0.20010796294716016,
        #  0.1173165676349065, 0.018995903375630174, -0.0936304667639592, -0.2186584780123888, -0.35355339059326657,
        #  -0.4952253368529448, -0.6401278961199837, -0.7843761033402905, -0.9238795325113015, -1.0544854967402644,
        #  -1.1721269965857801, -1.2729698431820122, -1.3535533905932728, -1.410919532823475, -1.44272504665888,
        #  -1.4473329759338278, -1.4238795325112874, -1.3723139045499806, -1.2934093785581924, -1.188745259514001,
        #  -1.060660171779836, -0.9121784006734465, -0.7469119492021286, -0.5689418978340759, -0.3826834323650847,
        #  -0.19273951624637342, -0.0037486058335939876, 0.17976797618024848, 0.3535533905932494, 0.513751946480826,
        #  0.657030088271778, 0.7806773174560604, 0.8826834323650836, 0.9617893770276128, 1.0175099992752341,
        #  1.0501280903149102, 1.060660171779812, 1.0507955698725298, 1.0228113284850788, 0.9794664253564022,
        #  0.9238795325112797, 0.8593951747241315, 0.7894435642206863, 0.7173996101623902, 0.6464466094067147,
        #  0.5794499205209267, 0.5188455141475847, 0.4665476955305883, 0.4238795325112914, 0.3915286241467428,
        #  0.36952984604690525, 0.3572756472114723, 0.3535533905932829, 0.35660816765385406, 0.3642285168370686,
        #  0.3738515758179465, 0.38268343236510155, 0.38782983826253903, 0.3864320381986847, 0.3758022568393744,
        #  0.35355339059328345, 0.31771766582171546, 0.26684944423952583, 0.20010796294715488, 0.11731656763492643,
        #  0.01899590337562279, -0.09363046676396758, -0.21865847801236016, -0.3535533905932763, -0.49522533685295483,
        #  -0.6401278961199939, -0.7843761033403005, -0.923879532511311, -1.054485496740273, -1.1721269965857877,
        #  -1.2729698431819922, -1.3535533905932777, -1.410919532823478, -1.442725046658876, -1.447332975933827,
        #  -1.4238795325112847, -1.3723139045499761, -1.2934093785581857, -1.188745259513993, -1.0606601717798263,
        #  -0.9121784006734355, -0.7469119492021665, -0.5689418978340631, -0.38268343236507146, -0.19273951624641522,
        #  -0.0037486058335809425, 0.17976797618026097, 0.35355339059326113, 0.5137519464808366, 0.6570300882717873,
        #  0.7806773174560684, 0.8826834323650898, 0.961789377027598, 1.0175099992752372, 1.0501280903149115,
        #  1.060660171779812, 1.0507955698725284, 1.0228113284850764, 0.9794664253564132, 0.9238795325112754,
        #  0.8593951747241269, 0.7894435642206812, 0.7173996101623852, 0.6464466094067299, 0.5794499205209223,
        #  0.5188455141475807, 0.46654769553059866, 0.42387953251128874, 0.3915286241467409, 0.369529846046909,
        #  0.35727564721147165, 0.35355339059328283, 0.35660816765385445, 0.36422851683706925, 0.37385157581794437,
        #  0.382683432365102, 0.3878298382625392, 0.38643203819868593, 0.3758022568393733, 0.35355339059328145,
        #  0.317717665821725, 0.2668494442395217, 0.20010796294714972, 0.11731656763492004, 0.01899590337561541,
        #  -0.09363046676394132, -0.21865847801236926, -0.3535533905932859, -0.49522533685292325, -0.640127896120004,
        #  -0.7843761033403104, -0.9238795325112812, -1.0544854967402817, -1.1721269965857954, -1.2729698431819987,
        #  -1.3535533905932824, -1.4109195328234683, -1.4427250466588772, -1.4473329759338265, -1.4238795325112927,
        #  -1.3723139045499715, -1.2934093785581795, -1.1887452595140184, -1.0606601717798168, -0.9121784006734244,
        #  -0.7469119492021544, -0.5689418978340504, -0.382683432365113, -0.19273951624640195, -0.0037486058335678973,
        #  0.17976797618022158, 0.3535533905932728, 0.5137519464808472, 0.6570300882717579, 0.7806773174560763,
        #  0.8826834323650963, 0.9617893770276027, 1.0175099992752403, 1.0501280903149068, 1.060660171779812,
        #  1.050795569872527, 1.0228113284850842, 0.9794664253564096, 0.9238795325112712, 0.8593951747241416,
        #  0.7894435642206762, 0.7173996101623801, 0.6464466094067252, 0.5794499205209177, 0.5188455141475932,
        #  0.46654769553059533, 0.4238795325112862, 0.3915286241467469, 0.36952984604690786, 0.35727564721147115,
        #  0.3535533905932828, 0.35660816765385484, 0.3642285168370698, 0.37385157581794504, 0.38268343236510255,
        #  0.3878298382625387, 0.38643203819868555, 0.3758022568393722, 0.3535533905932877, 0.31771766582172195,
        #  0.2668494442395176, 0.20010796294716615, 0.11731656763491372, 0.018995903375608025, -0.09363046676394976,
        #  -0.2186584780123783, -0.35355339059325547, -0.4952253368529333, -0.6401278961200141, -0.7843761033402791,
        #  -0.9238795325112906, -1.0544854967402904, -1.1721269965857712, -1.272969843182005, -1.3535533905932873,
        #  -1.4109195328234714, -1.4427250466588786, -1.4473329759338285, -1.4238795325112903, -1.372313904549967,
        #  -1.2934093785581995, -1.1887452595140104, -1.060660171779807, -0.9121784006734591, -0.7469119492021424,
        #  -0.5689418978340376, -0.3826834323650998, -0.19273951624638866, -0.00374860583360892, 0.17976797618023413,
        #  0.35355339059328456, 0.5137519464808138, 0.6570300882717673, 0.7806773174560842, 0.8826834323650763,
        #  0.9617893770276074, 1.0175099992752434, 1.0501280903149084, 1.0606601717798123, 1.0507955698725313,
        #  1.0228113284850817, 0.979466425356406, 0.9238795325112846, 0.8593951747241368, 0.7894435642206712,
        #  0.717399610162396, 0.6464466094067203, 0.5794499205209132, 0.5188455141475892, 0.466547695530592,
        #  0.4238795325112944, 0.391528624146745, 0.3695298460469067, 0.3572756472114728, 0.3535533905932829,
        #  0.3566081676538553, 0.36422851683706786, 0.3738515758179457, 0.38268343236510305, 0.3878298382625388,
        #  0.38643203819868516, 0.37580225683937574, 0.3535533905932857, 0.31771766582171895, 0.26684944423953055,
        #  0.20010796294716088, 0.11731656763490739, 0.018995903375631285, -0.09363046676395803, -0.21865847801238747,
        #  -0.3535533905932652, -0.49522533685294334, -0.6401278961199823, -0.7843761033402891, -0.9238795325113001,
        #  -1.054485496740263, -1.1721269965857788, -1.2729698431820113, -1.3535533905932722, -1.4109195328234745,
        #  -1.4427250466588797, -1.4473329759338278, -1.4238795325112876, -1.3723139045499815, -1.2934093785581933,
        #  -1.1887452595140022, -1.0606601717798374, -0.9121784006734481, -0.7469119492021304, -0.5689418978340778,
        #  -0.38268343236508656, -0.19273951624637534, -0.003748605833595875, 0.17976797618024667, 0.3535533905932962,
        #  0.5137519464808245, 0.6570300882717767, 0.7806773174560593, 0.8826834323650826, 0.9617893770276121,
        #  1.0175099992752337, 1.0501280903149097, 1.060660171779812, 1.05079556987253, 1.0228113284850793,
        #  0.9794664253564026, 0.9238795325112803, 0.8593951747241322, 0.789443564220687, 0.717399610162391,
        #  0.6464466094067154, 0.5794499205209274, 0.5188455141475853, 0.46654769553058867, 0.42387953251129173,
        #  0.3915286241467431, 0.3695298460469054, 0.3572756472114723, 0.35355339059328283, 0.35660816765385406,
        #  0.3642285168370684, 0.37385157581794637, 0.38268343236510144, 0.387829838262539, 0.38643203819868477,
        #  0.37580225683937457, 0.3535533905932837, 0.31771766582171596, 0.26684944423952645, 0.20010796294715566,
        #  0.11731656763492732, 0.0189959033756239, -0.0936304667639663, -0.21865847801235883, -0.35355339059327495,
        #  -0.49522533685295345, -0.6401278961199924, -0.7843761033402991, -0.9238795325113096, -1.0544854967402717,
        #  -1.1721269965857866, -1.2729698431819914, -1.353553390593277, -1.4109195328234776, -1.4427250466588757,
        #  -1.4473329759338271, -1.423879532511285, -1.3723139045499768, -1.2934093785581866, -1.188745259513994,
        #  -1.0606601717798279, -0.912178400673437, -0.7469119492021682, -0.568941897834065, -0.38268343236507335,
        #  -0.1927395162464171, -0.00374860583358283, 0.17976797618025922, 0.35355339059325946, 0.5137519464808351,
        #  0.657030088271786, 0.7806773174560673, 0.882683432365089, 0.9617893770275974, 1.0175099992752368,
        #  1.0501280903149113, 1.060660171779812, 1.0507955698725286, 1.0228113284850766, 0.9794664253564136,
        #  0.9238795325112761, 0.8593951747241274, 0.7894435642206818, 0.7173996101623858, 0.6464466094067307,
        #  0.5794499205209228, 0.5188455141475812, 0.4665476955305992, 0.4238795325112892, 0.3915286241467412,
        #  0.3695298460469092, 0.3572756472114718, 0.35355339059328283, 0.3566081676538544, 0.36422851683706914,
        #  0.3738515758179442, 0.382683432365102, 0.38782983826253914, 0.386432038198686, 0.37580225683937346,
        #  0.35355339059328167, 0.3177176658217254, 0.26684944423952234, 0.20010796294715044, 0.11731656763492099,
        #  0.01899590337561652, -0.09363046676394021, -0.21865847801236798, -0.35355339059328456, -0.4952253368529218,
        #  -0.6401278961200025, -0.784376103340309, -0.9238795325112799, -1.0544854967402806, -1.1721269965857943,
        #  -1.2729698431819978, -1.353553390593282, -1.4109195328234678, -1.442725046658877, -1.4473329759338265,
        #  -1.4238795325112932, -1.3723139045499722, -1.2934093785581804, -1.1887452595140198, -1.060660171779818,
        #  -0.9121784006734259, -0.7469119492021562, -0.5689418978340521, -0.3826834323651149, -0.19273951624640384,
        #  -0.003748605833569729, 0.17976797618021984, 0.3535533905932711, 0.5137519464808458, 0.6570300882717566,
        #  0.780677317456075, 0.8826834323650954, 0.961789377027602, 1.0175099992752399, 1.0501280903149066,
        #  1.060660171779812, 1.0507955698725273, 1.0228113284850846, 0.9794664253564102, 0.9238795325112719,
        #  0.8593951747241424, 0.789443564220677, 0.7173996101623807, 0.6464466094067258, 0.5794499205209183,
        #  0.5188455141475936, 0.4665476955305959, 0.4238795325112865, 0.39152862414674716, 0.36952984604690803,
        #  0.35727564721147126, 0.3535533905932829, 0.3566081676538548, 0.3642285168370698, 0.3738515758179449,
        #  0.38268343236510244, 0.3878298382625387, 0.3864320381986856, 0.37580225683937235, 0.35355339059328805,
        #  0.3177176658217224, 0.2668494442395183, 0.20010796294716687, 0.11731656763491466, 0.01899590337560908,
        #  -0.09363046676394848, -0.2186584780123771, -0.3535533905932541, -0.4952253368529319, -0.6401278961200126,
        #  -0.7843761033402776, -0.9238795325112893, -1.0544854967402892, -1.1721269965857701, -1.272969843182004,
        #  -1.3535533905932866, -1.410919532823471, -1.4427250466588784, -1.4473329759338285, -1.4238795325112905,
        #  -1.3723139045499675, -1.2934093785582006, -1.1887452595140116, -1.0606601717798085, -0.9121784006734606,
        #  -0.7469119492021441, -0.5689418978340394, -0.38268343236510166, -0.19273951624639052, -0.0037486058336108075,
        #  0.17976797618023233, 0.3535533905932829, 0.5137519464808123, 0.6570300882717659, 0.780677317456083,
        #  0.8826834323650754, 0.9617893770276067, 1.017509999275243, 1.0501280903149082, 1.0606601717798123,
        #  1.0507955698725315, 1.0228113284850822, 0.9794664253564066, 0.9238795325112852, 0.8593951747241376,
        #  0.7894435642206719, 0.7173996101623966, 0.6464466094067209, 0.5794499205209138, 0.5188455141475897,
        #  0.46654769553059255, 0.42387953251129473, 0.3915286241467453, 0.36952984604690675, 0.357275647211473,
        #  0.35355339059328283, 0.3566081676538553, 0.3642285168370677, 0.3738515758179456, 0.382683432365103,
        #  0.3878298382625388, 0.3864320381986852, 0.37580225683937585, 0.353553390593286, 0.31771766582171934,
        #  0.26684944423953116, 0.2001079629471616, 0.11731656763490828, 0.018995903375632284, -0.09363046676395687,
        #  -0.21865847801238614, -0.35355339059326385, -0.49522533685294196, -0.6401278961199808, -0.7843761033402876,
        #  -0.9238795325112987, -1.0544854967402617, -1.172126996585778, -1.2729698431820105, -1.3535533905932715,
        #  -1.410919532823474, -1.4427250466588797, -1.4473329759338278, -1.423879532511288, -1.3723139045499821,
        #  -1.2934093785581942, -1.1887452595140033, -1.060660171779839, -0.9121784006734497, -0.7469119492021321,
        #  -0.5689418978340796, -0.38268343236508845, -0.19273951624637725, -0.0037486058335977623, 0.17976797618024487,
        #  0.3535533905932461, 0.5137519464808229, 0.6570300882717753, 0.7806773174560582, 0.8826834323650817,
        #  0.9617893770276115, 1.0175099992752332, 1.0501280903149097, 1.060660171779812, 1.05079556987253,
        #  1.0228113284850795, 0.979466425356403, 0.923879532511281, 0.8593951747241328, 0.7894435642206876,
        #  0.7173996101623916, 0.646446609406716, 0.579449920520928, 0.5188455141475858, 0.4665476955305892,
        #  0.4238795325112922, 0.3915286241467434, 0.36952984604690564, 0.3572756472114724, 0.35355339059328283,
        #  0.356608167653854, 0.3642285168370684, 0.37385157581794626, 0.38268343236510133, 0.387829838262539,
        #  0.3864320381986848, 0.37580225683937474, 0.353553390593284, 0.31771766582171634, 0.26684944423952706,
        #  0.20010796294715644, 0.1173165676349282, 0.0189959033756249, -0.09363046676396519, -0.2186584780123575,
        #  -0.35355339059327356, -0.495225336852952, -0.640127896119991, -0.7843761033402976, -0.9238795325113083,
        #  -1.0544854967402706, -1.1721269965857855, -1.2729698431819905, -1.3535533905932762, -1.4109195328234772,
        #  -1.4427250466588755, -1.4473329759338274, -1.4238795325112854, -1.3723139045499775, -1.2934093785581877,
        #  -1.1887452595139951, -1.0606601717798292, -0.9121784006734386, -0.7469119492021699, -0.5689418978340668,
        #  -0.3826834323650753, -0.19273951624641905, -0.0037486058335846617, 0.17976797618025742, 0.35355339059325774,
        #  0.5137519464808336, 0.6570300882717847, 0.7806773174560662, 0.8826834323650881, 0.9617893770275967,
        #  1.0175099992752363, 1.050128090314911, 1.060660171779812, 1.0507955698725286, 1.022811328485077,
        #  0.9794664253564141, 0.9238795325112767, 0.8593951747241281, 0.7894435642206827, 0.7173996101623865,
        #  0.6464466094067314, 0.5794499205209235, 0.5188455141475818, 0.4665476955305996, 0.4238795325112895,
        #  0.3915286241467415, 0.36952984604690936, 0.3572756472114719, 0.3535533905932829, 0.3566081676538544,
        #  0.36422851683706897, 0.37385157581794415, 0.3826834323651019, 0.38782983826253914, 0.38643203819868605,
        #  0.3758022568393736, 0.353553390593282, 0.31771766582172584, 0.2668494442395229, 0.20010796294715122,
        #  0.11731656763492188, 0.018995903375617518, -0.09363046676393905, -0.21865847801236665, -0.35355339059328317,
        #  -0.4952253368529204, -0.6401278961200011, -0.7843761033403076, -0.9238795325112784, -1.0544854967402792,
        #  -1.1721269965857932, -1.272969843181997, -1.353553390593281, -1.4109195328234674, -1.4427250466588768,
        #  -1.4473329759338265, -1.4238795325112936, -1.3723139045499728, -1.2934093785581813, -1.1887452595140209,
        #  -1.0606601717798194, -0.9121784006734276, -0.7469119492021579, -0.568941897834054, -0.3826834323651167,
        #  -0.19273951624640576, -0.0037486058335716166, 0.17976797618021803, 0.35355339059326946, 0.5137519464808442,
        #  0.6570300882717552, 0.7806773174560739, 0.8826834323650944, 0.9617893770276014, 1.0175099992752394,
        #  1.0501280903149064, 1.0606601717798123, 1.0507955698725275, 1.0228113284850848, 0.9794664253564106,
        #  0.9238795325112724, 0.859395174724143, 0.7894435642206776, 0.7173996101623815, 0.6464466094067265,
        #  0.5794499205209189, 0.5188455141475943, 0.4665476955305963, 0.42387953251128685, 0.3915286241467474,
        #  0.3695298460469082, 0.35727564721147126, 0.35355339059328283, 0.3566081676538547, 0.36422851683706964,
        #  0.3738515758179448, 0.38268343236510244, 0.3878298382625386, 0.38643203819868566, 0.37580225683937246,
        #  0.3535533905932883, 0.31771766582172284, 0.26684944423951884, 0.2001079629471676, 0.11731656763491555,
        #  0.018995903375610135, -0.09363046676394732, -0.2186584780123758, -0.35355339059325275, -0.49522533685293046,
        #  -0.6401278961200113, -0.7843761033402763, -0.923879532511288, -1.054485496740288, -1.172126996585769,
        #  -1.2729698431820031, -1.353553390593286, -1.4109195328234705, -1.4427250466588781, -1.4473329759338287,
        #  -1.423879532511291, -1.3723139045499684, -1.2934093785582015, -1.1887452595140127, -1.0606601717798099,
        #  -0.9121784006734621, -0.7469119492021459, -0.5689418978340413, -0.38268343236510355, -0.1927395162463924,
        #  -0.003748605833612695, 0.17976797618023058, 0.35355339059328117, 0.5137519464808108, 0.6570300882717647,
        #  0.7806773174560819, 0.8826834323650745, 0.961789377027606, 1.0175099992752425, 1.050128090314908,
        #  1.060660171779812, 1.0507955698725318, 1.0228113284850826, 0.9794664253564072, 0.9238795325112857,
        #  0.8593951747241383, 0.7894435642206727, 0.7173996101623974, 0.6464466094067216, 0.5794499205209145,
        #  0.5188455141475903, 0.46654769553059294, 0.4238795325112952, 0.3915286241467455, 0.369529846046907,
        #  0.357275647211473, 0.35355339059328283, 0.3566081676538551, 0.3642285168370676, 0.3738515758179455,
        #  0.38268343236510294, 0.38782983826253875, 0.38643203819868527, 0.375802256839376, 0.3535533905932863,
        #  0.3177176658217198, 0.2668494442395317, 0.20010796294716238, 0.11731656763490922, 0.018995903375633394,
        #  -0.09363046676395559, -0.21865847801238492, -0.35355339059326235, -0.49522533685294046, -0.6401278961199793,
        #  -0.7843761033402862, -0.9238795325112975, -1.0544854967402606, -1.1721269965857768, -1.2729698431820096,
        #  -1.3535533905932708, -1.4109195328234736, -1.4427250466588795, -1.447332975933828, -1.4238795325112883,
        #  -1.3723139045499826, -1.293409378558195, -1.1887452595140044, -1.0606601717798403, -0.9121784006734511,
        #  -0.7469119492021338, -0.5689418978340814, -0.38268343236509034, -0.19273951624637914, -0.003748605833599594,
        #  0.17976797618024312, 0.3535533905932929, 0.5137519464808213, 0.657030088271774, 0.7806773174560571,
        #  0.8826834323650808, 0.9617893770276108, 1.0175099992752328, 1.0501280903149093, 1.060660171779812,
        #  1.0507955698725304, 1.02281132848508, 0.9794664253564036, 0.9238795325112816, 0.8593951747241335,
        #  0.7894435642206884, 0.7173996101623923, 0.6464466094067167, 0.5794499205209286, 0.5188455141475863,
        #  0.4665476955305896, 0.4238795325112925, 0.3915286241467436, 0.3695298460469058, 0.3572756472114724,
        #  0.3535533905932829, 0.35660816765385384, 0.36422851683706825, 0.37385157581794615, 0.3826834323651013,
        #  0.3878298382625389, 0.3864320381986849, 0.3758022568393749, 0.3535533905932843, 0.3177176658217168,
        #  0.2668494442395276, 0.20010796294715716, 0.11731656763492915, 0.01899590337562601, -0.09363046676396403,
        #  -0.21865847801235616, -0.3535533905932721, -0.4952253368529505, -0.6401278961199894, -0.7843761033402962,
        #  -0.9238795325113068, -1.0544854967402693, -1.1721269965857846, -1.2729698431819894, -1.3535533905932755,
        #  -1.4109195328234767, -1.4427250466588752, -1.4473329759338274, -1.4238795325112856, -1.3723139045499781,
        #  -1.2934093785581886, -1.1887452595139965, -1.0606601717798305, -0.9121784006734402, -0.7469119492021716,
        #  -0.5689418978340686, -0.3826834323650771, -0.19273951624642094, -0.003748605833586549, 0.1797679761802556,
        #  0.35355339059325613, 0.513751946480832, 0.6570300882717833, 0.780677317456065, 0.8826834323650872,
        #  0.961789377027596, 1.0175099992752359, 1.0501280903149108, 1.0606601717798123, 1.050795569872529,
        #  1.0228113284850773, 0.9794664253564147, 0.9238795325112773, 0.8593951747241289, 0.7894435642206834,
        #  0.7173996101623872, 0.646446609406732, 0.5794499205209241, 0.5188455141475824, 0.46654769553060016,
        #  0.42387953251128985, 0.3915286241467417, 0.3695298460469095, 0.3572756472114719, 0.35355339059328283,
        #  0.35660816765385434, 0.3642285168370689, 0.37385157581794404, 0.38268343236510177, 0.38782983826253914,
        #  0.3864320381986861, 0.3758022568393738, 0.3535533905932823, 0.3177176658217262, 0.2668494442395235,
        #  0.20010796294715194, 0.11731656763492276, 0.018995903375618572, -0.09363046676393777, -0.21865847801236532,
        #  -0.35355339059328184, -0.4952253368529189, -0.6401278961199997, -0.784376103340306, -0.9238795325112771,
        #  -1.0544854967402781, -1.1721269965857921, -1.2729698431819958, -1.3535533905932804, -1.410919532823467,
        #  -1.4427250466588766, -1.4473329759338267, -1.423879532511294, -1.3723139045499735, -1.2934093785581822,
        #  -1.188745259514022, -1.060660171779821, -0.9121784006734293, -0.7469119492021595, -0.5689418978340558,
        #  -0.38268343236511865, -0.19273951624640762, -0.003748605833573476, 0.17976797618021623, 0.3535533905932678,
        #  0.5137519464808427, 0.6570300882717539, 0.7806773174560728, 0.8826834323650935, 0.9617893770276007,
        #  1.017509999275239, 1.0501280903149062, 1.060660171779812, 1.0507955698725278, 1.0228113284850853,
        #  0.9794664253564112, 0.9238795325112731, 0.8593951747241437, 0.7894435642206784, 0.7173996101623823,
        #  0.6464466094067272, 0.5794499205209196, 0.5188455141475949, 0.46654769553059683, 0.4238795325112873,
        #  0.39152862414674766, 0.3695298460469084, 0.3572756472114714, 0.35355339059328283, 0.3566081676538547,
        #  0.3642285168370695, 0.3738515758179447, 0.3826834323651023, 0.3878298382625386, 0.3864320381986857,
        #  0.3758022568393727, 0.3535533905932886, 0.3177176658217232, 0.2668494442395194, 0.20010796294716832,
        #  0.11731656763491644, 0.01899590337561119, -0.09363046676394615, -0.21865847801237448, -0.35355339059325136,
        #  -0.49522533685292897, -0.6401278961200099, -0.7843761033402749, -0.9238795325112866, -1.0544854967402868,
        #  -1.172126996585768, -1.2729698431820022, -1.3535533905932853, -1.41091953282347, -1.442725046658878,
        #  -1.4473329759338287, -1.4238795325112914, -1.3723139045499688, -1.2934093785582024, -1.1887452595140138,
        #  -1.0606601717798112, -0.9121784006734638, -0.7469119492021475, -0.568941897834043, -0.38268343236510544,
        #  -0.19273951624639432, -0.0037486058336145267, 0.17976797618022877, 0.35355339059327956, 0.5137519464808092,
        #  0.6570300882717633, 0.7806773174560808, 0.8826834323650736, 0.9617893770276054, 1.017509999275242,
        #  1.0501280903149077, 1.060660171779812, 1.0507955698725318, 1.0228113284850828, 0.9794664253564076,
        #  0.9238795325112863, 0.859395174724139, 0.7894435642206734, 0.7173996101623981, 0.6464466094067223,
        #  0.5794499205209152, 0.518845514147591, 0.4665476955305935, 0.4238795325112955, 0.3915286241467458,
        #  0.36952984604690714, 0.3572756472114731, 0.3535533905932828, 0.35660816765385506, 0.3642285168370676,
        #  0.37385157581794537, 0.3826834323651029, 0.38782983826253875, 0.3864320381986853, 0.3758022568393762,
        #  0.35355339059328655, 0.3177176658217202, 0.2668494442395323, 0.20010796294716315, 0.11731656763491011,
        #  0.018995903375634393, -0.09363046676395448, -0.21865847801238358, -0.353553390593261, -0.4952253368529391,
        #  -0.6401278961199779, -0.7843761033402847, -0.9238795325112961, -1.0544854967402593, -1.1721269965857757,
        #  -1.2729698431820087, -1.35355339059327, -1.4109195328234732, -1.4427250466588792, -1.447332975933828,
        #  -1.4238795325112887, -1.3723139045499833, -1.293409378558196, -1.1887452595140056, -1.0606601717798416,
        #  -0.9121784006734528, -0.7469119492021355, -0.5689418978340832, -0.3826834323650922, -0.19273951624638103,
        #  -0.0037486058336014816, 0.17976797618024132, 0.3535533905932427, 0.5137519464808199, 0.6570300882717727,
        #  0.780677317456056, 0.88268343236508, 0.9617893770276101, 1.0175099992752323, 1.0501280903149093,
        #  1.060660171779812, 1.0507955698725304, 1.0228113284850804, 0.9794664253564042, 0.9238795325112821,
        #  0.8593951747241342, 0.7894435642206891, 0.717399610162393, 0.6464466094067175, 0.5794499205209293,
        #  0.518845514147587, 0.4665476955305901, 0.42387953251129284, 0.3915286241467439, 0.369529846046906,
        #  0.3572756472114726, 0.3535533905932829, 0.35660816765385384, 0.36422851683706814, 0.37385157581794604,
        #  0.3826834323651012, 0.3878298382625389, 0.3864320381986849, 0.375802256839375, 0.3535533905932846,
        #  0.3177176658217172, 0.2668494442395282, 0.20010796294715794, 0.11731656763493004, 0.018995903375627066,
        #  -0.09363046676396275, -0.21865847801235488, -0.35355339059327073, -0.4952253368529491, -0.640127896119988,
        #  -0.7843761033402947, -0.9238795325113056, -1.0544854967402681, -1.1721269965857832, -1.2729698431819887,
        #  -1.3535533905932748, -1.4109195328234763, -1.4427250466588752, -1.4473329759338274, -1.423879532511286,
        #  -1.3723139045499788, -1.2934093785581895, -1.1887452595139976, -1.060660171779832, -0.9121784006734417,
        #  -0.7469119492021734, -0.5689418978340705, -0.382683432365079, -0.19273951624642283, -0.0037486058335884087,
        #  0.17976797618025386, 0.3535533905932544, 0.5137519464808306, 0.657030088271782, 0.7806773174560638,
        #  0.8826834323650863, 0.9617893770275954, 1.0175099992752354, 1.0501280903149106, 1.060660171779812,
        #  1.050795569872529, 1.0228113284850777, 0.979466425356415, 0.923879532511278, 0.8593951747241294,
        #  0.7894435642206841, 0.717399610162388, 0.6464466094067327, 0.5794499205209248, 0.518845514147583,
        #  0.46654769553060055, 0.4238795325112903, 0.391528624146742, 0.36952984604690975, 0.35727564721147204,
        #  0.35355339059328283, 0.3566081676538543, 0.3642285168370688, 0.3738515758179439, 0.38268343236510177,
        #  0.38782983826253914, 0.38643203819868616, 0.37580225683937396, 0.35355339059328256, 0.31771766582172667,
        #  0.26684944423952406, 0.20010796294715272, 0.11731656763492371, 0.018995903375619627, -0.0936304667639366,
        #  -0.218658478012364, -0.3535533905932805, -0.4952253368529175, -0.6401278961199982, -0.7843761033403047,
        #  -0.9238795325112757, -1.0544854967402768, -1.172126996585791, -1.2729698431819951, -1.3535533905932797,
        #  -1.4109195328234663, -1.4427250466588766, -1.4473329759338267, -1.4238795325112945, -1.3723139045499742,
        #  -1.293409378558183, -1.188745259514023, -1.0606601717798223, -0.9121784006734308, -0.7469119492021614,
        #  -0.5689418978340577, -0.3826834323651205, -0.1927395162464095, -0.003748605833575336, 0.17976797618021445]
        ths = statistic_threshold(clean_signal, fs_dict_BVP, temp_ths)
        len_before, len_after, time_signal_index = eliminate_noise_in_time(
            bp_bvp, fs_dict_BVP, ths, cycle)
        # print('len_before ', len_before, ' len_after ', len_after)
        # print(time_signal_index)
        df = pd.DataFrame(bp_bvp, columns=['BVP'])

        df = df.iloc[time_signal_index, :]
        df = df.reset_index(drop=True)

        # plt.plot(df)
        # plt.show()

        features_of_windows = get_samples(df, 0, True)
        if features_of_windows.empty:
            return [2, 0, 0, 0]
        features = features_of_windows.mean().transpose()
        print("features: ", features)
        ppg_res = PPG_ML_output(features, feats, models)
        results =  ppg_res + eda_res
        final_res, total, threshold = final(results, models + eda_models)
        print(final_res)
        # res = st.mode(results).mode[0]
    print("Stressed") if final_res else print("Not stressed")
    return [final_res, features['HR_mean'], total, threshold]

# # Read the CSV file
# df = pd.read_csv(file_path)
#
# # Convert the DataFrame to a NumPy array
# data = df.columns.values
# data = np.array(data).astype(float)
#
# print(is_stressed(data, 1380))

# # Standardize
# mean = np.mean(data)
# std = np.std(data)
# data = ((data - mean) / std)[64:]
# # print(data)
#
# # Signal preprocessing
#
# # Bp
# bp_bvp = butter_bandpassfilter(data, 0.5, 10, fs_dict_BVP, order=2)
#
# # Time
# fwd = moving_average(bp_bvp, size=3)
# bwd = moving_average(bp_bvp[::-1], size=3)
# bp_bvp = np.mean(np.vstack((fwd, bwd[::-1])), axis=0)
#
# signal_5_percent = int(len(bp_bvp) * 0.05)
# # print(signal_5_percent)
# clean_signal = bp_bvp[3380:3380 + signal_5_percent]
# ths = statistic_threshold(clean_signal, fs_dict_BVP, temp_ths)
# len_before, len_after, time_signal_index = eliminate_noise_in_time(bp_bvp, fs_dict_BVP, ths, cycle)
# # print('len_before ', len_before, ' len_after ', len_after)
# # print(time_signal_index)
# df = pd.DataFrame(bp_bvp, columns=['BVP'])
#
# df = df.iloc[time_signal_index, :]
# df = df.reset_index(drop=True)
#
# # plt.plot(df)
# # plt.show()
#
# features_of_windows = get_samples(df, 0, True)
# features = features_of_windows.mean().transpose()
# print("features: ", features)
# print("Stressed") if ML_output(features, feats, models) else print("Not stressed")
